{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/laboni/CS291/Project3/CS291_project3/chat_app/src/MessageList.js\";\nimport React from 'react';\nimport './App.css';\nimport Popup from './Popup';\n\nclass MessageList extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.togglePopup = () => {\n      this.scrollToBottom();\n      this.atBottom = true;\n      this.setState({\n        showPopup: false\n      });\n    };\n\n    this.scrollToBottom = () => {\n      this.messagesEnd.scrollIntoView({\n        behavior: \"smooth\"\n      });\n      this.props.changeScrollState(true);\n      console.log(\"At bottom: \", true);\n    };\n\n    this.handleScroll = e => {\n      let element = e.target;\n      console.log(element.scrollHeight, element.scrollTop, element.clientHeight);\n\n      if (element.scrollHeight - element.scrollTop - 1 < element.clientHeight) {\n        this.props.changeScrollState(true);\n        this.atBottom = true;\n        console.log(\"At bottom from handleScroll: \", true);\n        this.setState({\n          showPopup: false\n        });\n      } else {\n        this.props.changeScrollState(false);\n        this.atBottom = false;\n        console.log(\"At bottom from handleScroll: \", false);\n      }\n    };\n\n    this.renderMessage = message => {\n      const member = message.user;\n      const text = message.message;\n      var date = new Date(message.created * 1000);\n      var hours = date.getHours();\n      var minutes = \"0\" + date.getMinutes();\n      const created = hours + ':' + minutes.substr(-2);\n      const serverMessage = member === 'Server';\n      const messageType = serverMessage ? \"Server\" : \"Message\";\n      const sender = serverMessage ? \"\" : member;\n      const currentMember = sessionStorage.getItem('currentUsername');\n      const messageFromMe = sender === currentMember;\n      const className = messageFromMe ? \"Messages-message-currentMember\" : \"Messages-message\";\n      if (messageFromMe) this.messageFromSelf = true;else this.messageFromSelf = false;\n      return /*#__PURE__*/_jsxDEV(\"li\", {\n        className: messageType,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: className,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"Message-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"username\",\n              children: sender\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 12\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-body\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text\",\n                children: text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"created\",\n                children: created\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 13\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 12\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 10\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 8\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 7\n      }, this);\n    };\n\n    this.state = {\n      showPopup: false\n    };\n    this.atBottom = true;\n    this.messageFromSelf = true;\n    this.togglePopup = this.togglePopup.bind(this);\n  }\n\n  componentDidMount() {\n    if (!this.props.atBottom && this.messageFromSelf) {\n      this.scrollToBottom();\n    } else if (this.props.atBottom) {\n      this.scrollToBottom();\n    }\n  }\n\n  componentDidUpdate() {\n    if (!this.props.atBottom && this.messageFromSelf) {\n      this.scrollToBottom();\n    } else if (this.props.atBottom) {\n      this.scrollToBottom();\n    }\n  }\n\n  render() {\n    console.log(\"Initial: \", this.atBottom);\n    console.log(\"showPopup: \", this.state.showPopup);\n    return /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"MessageList-container\",\n      onScroll: this.handleScroll,\n      children: [this.props.messages.map(m => this.renderMessage(m)), this.state.showPopup || !this.atBottom ? /*#__PURE__*/_jsxDEV(Popup, {\n        closePopup: this.togglePopup.bind(this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 52\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"li\", {\n        style: {\n          float: \"left\",\n          clear: \"both\"\n        },\n        ref: el => {\n          this.messagesEnd = el;\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default MessageList;","map":{"version":3,"sources":["/home/laboni/CS291/Project3/CS291_project3/chat_app/src/MessageList.js"],"names":["React","Popup","MessageList","Component","constructor","props","togglePopup","scrollToBottom","atBottom","setState","showPopup","messagesEnd","scrollIntoView","behavior","changeScrollState","console","log","handleScroll","e","element","target","scrollHeight","scrollTop","clientHeight","renderMessage","message","member","user","text","date","Date","created","hours","getHours","minutes","getMinutes","substr","serverMessage","messageType","sender","currentMember","sessionStorage","getItem","messageFromMe","className","messageFromSelf","state","bind","componentDidMount","componentDidUpdate","render","messages","map","m","float","clear","el"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport './App.css';\r\nimport Popup from './Popup'\r\n\r\nclass MessageList extends React.Component{\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      showPopup: false\r\n    }\r\n    this.atBottom = true\r\n    this.messageFromSelf = true\r\n    this.togglePopup = this.togglePopup.bind(this)\r\n  }\r\n  togglePopup = () => {\r\n    this.scrollToBottom();\r\n    this.atBottom = true;\r\n    this.setState({showPopup: false})\r\n    }\r\n  componentDidMount() {\r\n    if(!this.props.atBottom && this.messageFromSelf){\r\n            this.scrollToBottom();}\r\n    else if(this.props.atBottom){\r\n          this.scrollToBottom();}\r\n  }\r\n  \r\n  componentDidUpdate() {\r\n    if(!this.props.atBottom && this.messageFromSelf){\r\n            this.scrollToBottom();}\r\n    else if(this.props.atBottom){\r\n          this.scrollToBottom();}\r\n  }\r\n\r\n  scrollToBottom = () => { \r\n    this.messagesEnd.scrollIntoView({ behavior: \"smooth\" });\r\n    this.props.changeScrollState(true);\r\n    console.log(\"At bottom: \",true)\r\n    \r\n  }\r\n\r\n  handleScroll = e => {\r\n    let element = e.target\r\n    console.log(element.scrollHeight, element.scrollTop, element.clientHeight)\r\n    if (element.scrollHeight - element.scrollTop - 1 < element.clientHeight) {\r\n      this.props.changeScrollState(true); \r\n      this.atBottom = true\r\n      console.log(\"At bottom from handleScroll: \",true)\r\n      this.setState({showPopup: false})\r\n    }\r\n    else{\r\n      this.props.changeScrollState(false);  \r\n      this.atBottom = false\r\n      console.log(\"At bottom from handleScroll: \",false)\r\n    }\r\n  }\r\n  render() {\r\n    console.log(\"Initial: \", this.atBottom)\r\n    console.log(\"showPopup: \", this.state.showPopup)\r\n    return (\r\n      <ul className = \"MessageList-container\" onScroll={this.handleScroll}>\r\n        {this.props.messages.map(m => this.renderMessage(m))}\r\n        {(this.state.showPopup || !this.atBottom)? <Popup closePopup={this.togglePopup.bind(this)}/>: null}\r\n        <li style={{ float:\"left\", clear: \"both\" }}\r\n        ref={(el) => { this.messagesEnd = el; }}>\r\n        </li>\r\n      </ul>\r\n    );\r\n  }\r\n\r\n  renderMessage = (message) => {\r\n    const member = message.user;\r\n    const text = message.message;\r\n    var date = new Date(message.created*1000);\r\n    var hours = date.getHours();\r\n    var minutes = \"0\" + date.getMinutes();\r\n    const created = hours + ':' + minutes.substr(-2)\r\n    const serverMessage = member === 'Server';\r\n    const messageType = serverMessage?\r\n    \t\"Server\" : \"Message\";\r\n    const sender = serverMessage?\r\n    \t\"\" : member;\r\n    const currentMember = sessionStorage.getItem( 'currentUsername' );\r\n    const messageFromMe = sender === currentMember;\r\n    const className = messageFromMe ?\r\n      \"Messages-message-currentMember\" : \"Messages-message\";\r\n    if(messageFromMe)\r\n      this.messageFromSelf = true\r\n    else\r\n      this.messageFromSelf = false\r\n    return (\r\n      <li className={messageType} >\r\n      \t<div className = {className}>\r\n  \t      <div className=\"Message-content\">\r\n  \t        <div className=\"username\">\r\n  \t          {sender}\r\n  \t        </div>\r\n  \t        <div className=\"message-body\">\r\n  \t\t        <div className=\"text\">{text}</div>\r\n  \t\t        <div className=\"created\">{created}</div>\r\n  \t        </div>\r\n  \t      </div>\r\n  \t    </div>\r\n      </li>\r\n    );\r\n  }\r\n}\r\nexport default MessageList"]},"metadata":{},"sourceType":"module"}